(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-outside-apply"],{"0af7":function(t,e,i){"use strict";i.r(e);var n=i("4e9a"),a=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a},"4e9a":function(t,e,i){"use strict";var n=i("4ea4");i("c975"),i("a15b"),i("d81d"),i("a434"),i("ac1f"),i("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("5530")),s=(n(i("e143")),n(i("c49e"))),o=n(i("1f79")),c=(n(i("5ff6")),n(i("bb99"))),u=n(i("6820")),l=n(i("96c4")),d=i("2f62"),r={data:function(){return{code:"",itemId:"",itemName:"",noDuty:!0,dutyIndex:0,startDate:"请选择开工日期",startTime:"请选择开工时间",machineTypeIndex:0,machineModel:"",remark:"",workContent:[],number:"",timeList:[],newTimeList:[],deleteTimeList:[],updateTimeList:[]}},computed:(0,a.default)({},(0,d.mapState)(["projectMsg","machineTypes","dutyTypes"])),components:{showToast:s.default,ContentBox:u.default,TimeList:l.default},onLoad:function(t){this.itemName=this.projectMsg.projectName,console.log(this.itemName),t.code?(this.code=t.code,this.noDuty=!1,uni.setNavigationBarTitle({title:"编辑工时"}),this.getMachineWorkingByCode(this.code)):(this.noDuty=!0,uni.setNavigationBarTitle({title:"添加记录"}))},onShow:function(){var t=getCurrentPages(),e=t[t.length-1],i=e.data;i&&(this.workContent=i)},methods:{getMachineWorkingByCode:function(t){var e=this;o.default.getMachineWorkingByCode(t,{},(function(t){if(console.log("获取机械工时详情: ",t),200===t.data.code){var i=t.data.data;e.itemId=i.id,e.timeList=i.machineWorkingHoursTimeVos,e.dutyIndex=1*i.schedule,e.machineTypes.map((function(t,n){t.type===i.machineType&&(e.machineTypeIndex=n)})),e.machineModel=i.machineModel,e.workContent=i.jobContent.split(","),e.number=i.number}}))},changeDuty:function(t){console.log(t.detail),this.noDuty=!1,this.dutyIndex=t.detail.value},changeStartDate:function(t){this.startDate=t.detail.value},changeStartTime:function(t){console.log(t.detail),this.startTime=t.detail.value},addTimeList:function(){var t={startTime:"",completeTime:""};this.code&&this.newTimeList.push(t),this.timeList.push(t)},getStartTime:function(t,e){this.timeList[e].startTime=t,this.code&&this.timeList[e].id&&(this.isInList(this.timeList[e],this.updateTimeList)||this.updateTimeList.push({id:this.timeList[e].id,startTime:this.timeList[e].startTime,completeTime:this.timeList[e].completeTime}))},getEndTime:function(t,e){this.timeList[e].completeTime=t,this.code&&this.timeList[e].id&&(this.isInList(this.timeList[e],this.updateTimeList)||this.updateTimeList.push({id:this.timeList[e].id,startTime:this.timeList[e].startTime,completeTime:this.timeList[e].completeTime}))},isInList:function(t,e){var i=!1;return e.map((function(e,n){e.id!==t.id||(i=!0)})),i},deleteTimeItem:function(t){var e=this.timeList[t];if(e.id){var i;this.deleteTimeList.push({id:e.id}),this.updateTimeList.map((function(t,n){t.id===e.id&&(i=n)})),this.updateTimeList.splice(i,1)}else{var n=this.newTimeList.indexOf(e);this.newTimeList.splice(n,1)}this.timeList.splice(t,1)},changeMachineType:function(t){console.log(t.detail),this.machineTypeIndex=t.detail.value},numberInput:function(t){var e=this;this.$nextTick((function(){var i=t.detail.value;e.number=c.default.numberFilter(i)}))},chooseWorkContent:function(){var t=this.workContent;uni.navigateTo({url:"./workContent?originList="+JSON.stringify(t)})},removeWorkContent:function(t){var e=this;this.workContent.map((function(i,n){i===t&&e.workContent.splice(n,1)}))},applySubmit:function(){if(this.noDuty)uni.showToast({title:"请选择班次",icon:"none",duration:1500});else if(""!==this.machineModel)if(0!==this.workContent.length){if(this.timeList.length>0){var t=!0;if(this.timeList.map((function(e){e.startTime&&e.completeTime||(t=!1)})),!t)return void uni.showToast({title:"请补充台班时段",icon:"none",duration:1500})}else if(""===this.number)return void uni.showToast({title:"请输入车次或台班时间",icon:"none",duration:1500});var e={machineModel:this.machineModel,machineType:this.machineTypes[this.machineTypeIndex].type,projectCode:this.projectMsg.projectCode,schedule:this.dutyIndex,number:this.number,jobContent:this.workContent.join(",")};this.code?this.editMachineReq(e):this.addMachineReq(e)}else uni.showToast({title:"请选择工作内容",icon:"none",duration:1500});else uni.showToast({title:"请输入机械型号",icon:"none",duration:1500})},addMachineReq:function(t){var e=Object.assign(t,{machineWorkingHoursTimeInsertBos:this.timeList});console.log(e),o.default.addMachineWorking({"Content-Type":"application/json"},e,(function(t){console.log("开工申请---》: ",t),200===t.data.code&&uni.showModal({title:"提示",content:"申请成功",showCancel:!1,success:function(t){t.confirm&&uni.navigateBack({delta:1})}})}))},editMachineReq:function(t){var e={id:this.itemId,code:this.code,driverMachineWorkingHoursTimeDeleteBos:this.deleteTimeList,driverMachineWorkingHoursTimeInsertBos:this.newTimeList,driverMachineWorkingHoursTimeUpdateBos:this.updateTimeList};console.log(Object.assign(e,t)),o.default.driverUpdateMachineWorking({"Content-Type":"application/json"},Object.assign(e,t),(function(t){console.log("司机修改工时: ",t),200===t.data.code&&uni.showModal({title:"提示",content:"操作成功",showCancel:!1,success:function(t){t.confirm&&uni.navigateBack({delta:1})}})}))}}};e.default=r},"618b":function(t,e,i){"use strict";i.r(e);var n=i("ec57"),a=i("0af7");for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);i("6591");var o,c=i("f0c5"),u=Object(c["a"])(a["default"],n["b"],n["c"],!1,null,"7244b08f",null,!1,n["a"],o);e["default"]=u.exports},6591:function(t,e,i){"use strict";var n=i("ab73"),a=i.n(n);a.a},ab73:function(t,e,i){var n=i("eeec");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("40ff49ca",n,!0,{sourceMap:!1,shadowMode:!1})},ec57:function(t,e,i){"use strict";var n;i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"content"},[i("showToast",{ref:"toast"}),i("v-uni-view",{staticClass:"item-box1"},[i("v-uni-view",{staticClass:"title1"},[t._v("项目工地")]),i("v-uni-input",{staticClass:"my-input",attrs:{placeholder:"请输入项目工地",type:"text",value:t.itemName,disabled:!0}})],1),i("v-uni-view",{staticClass:"main"},[i("v-uni-view",{staticClass:"item-box2"},[i("v-uni-view",{staticClass:"item-line"},[i("v-uni-view",{staticClass:"title1"},[t._v("班次"),i("span",[t._v("*")])]),i("v-uni-picker",{attrs:{mode:"selector",range:t.dutyTypes,"range-key":"name",value:t.dutyIndex},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changeDuty.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker-btn"},[t._v(t._s(t.dutyTypes[t.dutyIndex].name))]),t.noDuty?i("v-uni-view",{staticClass:"no-choose"},[t._v("请选择班次")]):t._e()],1)],1),i("v-uni-view",{staticClass:"item-line"},[i("v-uni-view",{staticClass:"title1"},[t._v("机械类型"),i("span",[t._v("*")])]),i("v-uni-picker",{attrs:{mode:"selector",range:t.machineTypes,"range-key":"name",value:t.machineTypeIndex},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changeMachineType.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker-btn"},[t._v(t._s(t.machineTypes[t.machineTypeIndex].name))])],1)],1),i("v-uni-view",{staticClass:"item-line"},[i("v-uni-view",{staticClass:"title1"},[t._v("机械型号"),i("span",[t._v("*")])]),i("v-uni-input",{staticClass:"my-input",attrs:{placeholder:"请输入型号",type:"text"},model:{value:t.machineModel,callback:function(e){t.machineModel=e},expression:"machineModel"}})],1)],1),i("v-uni-view",{staticClass:"item-box2"},[i("v-uni-view",{staticClass:"item-line"},[i("v-uni-view",{staticClass:"title1"},[t._v("工作内容"),i("span",[t._v("*")])]),i("v-uni-view",{staticClass:"arrow",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseWorkContent.apply(void 0,arguments)}}},[t._v("请选择")])],1),i("Content-Box",{attrs:{param:t.workContent},on:{removeWorkContent:function(e){arguments[0]=e=t.$handleEvent(e),t.removeWorkContent.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"item-box1"},[i("v-uni-view",{staticClass:"title1"},[t._v("车次")]),i("v-uni-input",{staticClass:"my-input",attrs:{maxlength:"8",placeholder:"请输入车次",type:"number",value:t.number},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.numberInput.apply(void 0,arguments)}},model:{value:t.number,callback:function(e){t.number=e},expression:"number"}})],1),t._l(t.timeList,(function(e,n){return[i("Time-List",{key:n+"_0",attrs:{listId:n,dateObj:e,addDelete:!0},on:{deleteTimeItem:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteTimeItem.apply(void 0,arguments)},getStartTime:function(e){arguments[0]=e=t.$handleEvent(e),t.getStartTime.apply(void 0,arguments)},getEndTime:function(e){arguments[0]=e=t.$handleEvent(e),t.getEndTime.apply(void 0,arguments)}}})]})),i("v-uni-view",{staticClass:"item-box1 item-center",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.addTimeList.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"add-item"},[t._v("添加台班时段")])],1)],2),i("v-uni-view",{staticClass:"btn-box"},[i("v-uni-view",{staticClass:"submit-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.applySubmit()}}},[t._v("提交")])],1)],1)},s=[]},eeec:function(t,e,i){var n=i("24fb"),a=i("1de5"),s=i("8e27");e=n(!1);var o=a(s);e.push([t.i,".content[data-v-7244b08f]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:%?20?% %?30?% %?140?%;height:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.main[data-v-7244b08f]{-webkit-box-flex:1;-webkit-flex-grow:1;flex-grow:1;overflow-y:auto}.item-box1 uni-view[data-v-7244b08f]{-webkit-box-flex:0;-webkit-flex-grow:0;flex-grow:0}.my-input[data-v-7244b08f]{text-align:right;font-size:%?28?%;padding-left:%?20?%;-webkit-box-flex:1;-webkit-flex-grow:1;flex-grow:1}.title1[data-v-7244b08f]{font-size:%?32?%;color:#333;font-weight:700}.arrow[data-v-7244b08f]{padding-right:%?30?%;background:url("+o+") no-repeat;background-size:%?15?% %?24?%;background-position:100%}",""]),t.exports=e}}]);